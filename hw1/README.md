# HW1-Sequence Labeling
* Task: Label each frames obtained from speech signal
* DataSet: TIMIT Acoustic-Phonetic Continuous Speech Corpus

## Package Requirement:
* pandas (0.21.0)
* numpy (1.12.1)
* keras (2.0.7)
* tensorflow (r1.3)
* scikit-learn (0.19.0)

## Assume data directory tree

* data/
* ----fbank/
* --------test.ark
* --------train.ark
* ----label/
* --------train.lab
* ----mfcc/
* --------test.ark
* --------train.ark
* ----phones/
* --------48\_39.map
* ----48phone\_char.map

## Testing pre-trained model
```
#RNN
./hw1_rnn.sh data/ [output_file]

#CNN+RNN
./hw1_cnn.sh data/ [output_file]

#Best
./hw1_best.sh data/ [output_file]

```

## Training From Scratch
* Please run the preprocessing script before training from scratch.
```python
python sequence_data.py
```

* Start training
```python
python main.py data/ [output_file] -t [model_name]

# model_name argument only has 'rnn' and 'cnn'(cnn+rnn)
```

* Note: 
1. training from scratch may overwrite the previous pre-trained models
2. model\_best.py only do blending of three models: rnn.h5, cnn.h5, best.h5
3. To see best.h5 training code, please refer to [best.py](./best.py)

## Others
* label\_map.pkl: Label mapping using sklearn LabelBinarizer (generated by sequence\_data.py)

